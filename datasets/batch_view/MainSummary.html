
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Main Summary Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="CrashSummary.html" />
    
    
    <link rel="prev" href="cross_sectional.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Firefox Data Documentation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="../../concepts/terminology.html">
            
                <a href="../../concepts/terminology.html">
            
                    
                    Terminology
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../concepts/getting_started.html">
            
                <a href="../../concepts/getting_started.html">
            
                    
                    Getting Started
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../concepts/analysis_intro.html">
            
                <a href="../../concepts/analysis_intro.html">
            
                    
                    Analysis Quick Start
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../concepts/data_privacy.html">
            
                <a href="../../concepts/data_privacy.html">
            
                    
                    Data Privacy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../../concepts/choosing_a_dataset.html">
            
                <a href="../../concepts/choosing_a_dataset.html">
            
                    
                    Choosing a Dataset
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../../tools/stmo.html">
            
                <a href="../../tools/stmo.html">
            
                    
                    Intro to STMO / Re:dash
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../../concepts/analysis_gotchas.html">
            
                <a href="../../concepts/analysis_gotchas.html">
            
                    
                    Common Analysis Gotchas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../../concepts/review.html">
            
                <a href="../../concepts/review.html">
            
                    
                    Getting Review
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../">
            
                <a href="../">
            
                    
                    Data Collection and Datasets
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" >
            
                <span>
            
                    
                    Understanding our Data
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../../concepts/choosing_a_dataset.html">
            
                <a href="../../concepts/choosing_a_dataset.html">
            
                    
                    Choosing a dataset
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../../tools/experiments.html">
            
                <a href="../../tools/experiments.html">
            
                    
                    Tools for Experimentation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../../concepts/analysis_gotchas.html">
            
                <a href="../../concepts/analysis_gotchas.html">
            
                    
                    Common Analysis Gotchas
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../reference.html">
            
                <a href="../reference.html">
            
                    
                    Dataset Reference
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../pings.html">
            
                <a href="../pings.html">
            
                    
                    Pings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../derived.html">
            
                <a href="../derived.html">
            
                    
                    Derived Datasets
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.2.1" data-path="Longitudinal.html">
            
                <a href="Longitudinal.html">
            
                    
                    Longitudinal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2" data-path="cross_sectional.html">
            
                <a href="cross_sectional.html">
            
                    
                    Cross Sectional
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.2.2.3" data-path="MainSummary.html">
            
                <a href="MainSummary.html">
            
                    
                    Main Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.4" data-path="CrashSummary.html">
            
                <a href="CrashSummary.html">
            
                    
                    Crash Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.5" data-path="CrashAggregateView.html">
            
                <a href="CrashAggregateView.html">
            
                    
                    Crash Aggregate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.6" data-path="Events.html">
            
                <a href="Events.html">
            
                    
                    Events
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.7" data-path="SyncSummary.html">
            
                <a href="SyncSummary.html">
            
                    
                    Sync Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.8" data-path="Addons.html">
            
                <a href="Addons.html">
            
                    
                    Addons
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../../tools/experiments.html">
            
                <a href="../../tools/experiments.html">
            
                    
                    Experimental Datasets
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.3.1" data-path="../shield.html">
            
                <a href="../shield.html">
            
                    
                    Accessing Shield Study data
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../new_data.html">
            
                <a href="../new_data.html">
            
                    
                    Collecting New Data
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../tools/">
            
                <a href="../../tools/">
            
                    
                    Tools
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../tools/interfaces.html">
            
                <a href="../../tools/interfaces.html">
            
                    
                    Interfaces
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../../concepts/analysis_intro.html">
            
                <a href="../../concepts/analysis_intro.html">
            
                    
                    TMO & STMO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../../tools/advanced_analysis_with_atmo.html">
            
                <a href="../../tools/advanced_analysis_with_atmo.html">
            
                    
                    Advanced analysis with ATMO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../../cookbooks/realtime_analysis_plugin.html">
            
                <a href="../../cookbooks/realtime_analysis_plugin.html">
            
                    
                    Creating a Real-time Analysis Plugin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../../tools/distribution_viewer.html">
            
                <a href="../../tools/distribution_viewer.html">
            
                    
                    Distribution Viewer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.5" data-path="../../tools/hbase.html">
            
                <a href="../../tools/hbase.html">
            
                    
                    HBase
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.6" data-path="../../tools/rtmo.html">
            
                <a href="../../tools/rtmo.html">
            
                    
                    RTMO
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../tools/infrastructure.html">
            
                <a href="../../tools/infrastructure.html">
            
                    
                    Infrastructure
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../cookbooks/">
            
                <a href="../../cookbooks/">
            
                    
                    Cookbooks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../cookbooks/parquet.html">
            
                <a href="../../cookbooks/parquet.html">
            
                    
                    Working with Parquet Data on ATMO Clusters
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../cookbooks/create_a_dataset.html">
            
                <a href="../../cookbooks/create_a_dataset.html">
            
                    
                    Creating a custom re:dash dataset
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../../cookbooks/realtime_analysis_plugin.html">
            
                <a href="../../cookbooks/realtime_analysis_plugin.html">
            
                    
                    Creating a Real-time Analysis Plugin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../../cookbooks/longitudinal_examples.html">
            
                <a href="../../cookbooks/longitudinal_examples.html">
            
                    
                    Longitudinal Examples
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" >
            
                <span>
            
                    
                    About this Documentation
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../../meta/structure.html">
            
                <a href="../../meta/structure.html">
            
                    
                    Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../../meta/contributing.html">
            
                <a href="../../meta/contributing.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Main Summary</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="the-main-summary-dataset">The Main Summary dataset</h1>
<p>The Main Summary dataset is generated by <code>src/main/scala/com/mozilla/telemetry/views/MainSummaryView.scala</code>. It contains one record for every <a href="https://gecko.readthedocs.io/en/latest/toolkit/components/telemetry/telemetry/data/main-ping.html" target="_blank">main ping</a> submitted by Desktop Firefox.</p>
<p>More specifically, for a given day <code>D</code>, it contains one record for each Telemetry record on S3 starting with a prefix of <code>$D/telemetry/4/main/Firefox</code>, as long as the record contains a non-null value for <code>documentId</code>, <code>submissionDate</code>, and <code>Timestamp</code>. We do not ever expect nulls for these fields.</p>
<p>No attempt is made to de-duplicate submissions by <code>documentId</code>, so any analysis that could be affected by duplicate records should take care to remove duplicates using the <code>documentId</code> field.</p>
<h1 id="generating-the-dataset">Generating the dataset</h1>
<p>For distributed execution, we can build a self-contained JAR file, then run it with Spark.
For example, to generate the main_summary dataset for April 12, 2016 to April 28, 2016,
and storing the resulting data in an s3 bucket called <code>example_bucket</code>:</p>
<pre><code class="lang-bash">sbt assembly
spark-submit \
    --master yarn \
    --deploy-mode client \
    --class com.mozilla.telemetry.views.MainSummaryView \
    telemetry-batch-view-1.1.jar \
    --bucket example_bucket \
    --from 20160412 \
    --to 20160428
</code></pre>
<p>Notes:</p>
<ul>
<li>This dataset is updated daily via the <a href="https://github.com/mozilla/telemetry-airflow" target="_blank">telemetry-airflow</a> infrastructure.</li>
<li>The job DAG runs every day shortly after midnight UTC.</li>
<li>The job saves the resulting data to S3 as <a href="https://parquet.apache.org/" target="_blank">Parquet</a>-serialized <a href="https://spark.apache.org/docs/latest/api/java/org/apache/spark/sql/DataFrame.html" target="_blank">DataFrames</a>, under prefixes of the form <code>main_summary/v3/submission_date_s3=(YYYYMMDD SUBMISSION DATE)/sample_id=(INT VALUE)</code> in the <code>telemetry-parquet</code> bucket.</li>
<li>Each of these prefixes is a partition. There is a partition for each <code>submissionDate</code> + <code>sampleId</code>. Records without a <code>clientId</code> will not have a <code>sampleId</code> either, and will end up with a sample<em>id partition of `<em>_HIVE_DEFAULT_PARTITION</em></em>`.</li>
<li>The Main Summary data can be accessed <a href="https://gist.github.com/mreid-moz/518f7515aac54cd246635c333683ecce" target="_blank">from Spark</a> via clusters launched at <a href="https://analysis.telemetry.mozilla.org/" target="_blank">analysis.telemetry.mozilla.org</a> or via <a href="https://prestodb.io/" target="_blank">Presto</a> at <code>sql.telemetry.mozillla.org</code>. The table is called <code>main_summary</code>.</li>
</ul>
<h2 id="schemas-and-making-queries">Schemas and Making Queries</h2>
<p>As of 2016-07-05, the current version of the <code>main_summary</code> dataset is <code>v3</code>, and has a schema as follows:</p>
<pre><code>root
 |-- document_id: string (nullable = true)
 |-- client_id: string (nullable = true)
 |-- channel: string (nullable = true)
 |-- normalized_channel: string (nullable = true)
 |-- country: string (nullable = true)
 |-- city: string (nullable = true)
 |-- os: string (nullable = true)
 |-- os_version: string (nullable = true)
 |-- os_service_pack_major: long (nullable = true)
 |-- os_service_pack_minor: long (nullable = true)
 |-- windows_build_number: long (nullable = true)
 |-- windows_ubr: long (nullable = true)
 |-- install_year: long (nullable = true)
 |-- profile_creation_date: long (nullable = true)
 |-- subsession_start_date: string (nullable = true)
 |-- subsession_length: long (nullable = true)
 |-- distribution_id: string (nullable = true)
 |-- submission_date: string (nullable = true)
 |-- sync_configured: boolean (nullable = true)
 |-- sync_count_desktop: integer (nullable = true)
 |-- sync_count_mobile: integer (nullable = true)
 |-- app_build_id: string (nullable = true)
 |-- app_display_version: string (nullable = true)
 |-- app_name: string (nullable = true)
 |-- app_version: string (nullable = true)
 |-- timestamp: long (nullable = true)
 |-- env_build_id: string (nullable = true)
 |-- env_build_version: string (nullable = true)
 |-- env_build_arch: string (nullable = true)
 |-- e10s_enabled: boolean (nullable = true)
 |-- e10s_cohort: string (nullable = true)
 |-- locale: string (nullable = true)
 |-- active_experiment_id: string (nullable = true)
 |-- active_experiment_branch: string (nullable = true)
 |-- reason: string (nullable = true)
 |-- timezone_offset: integer (nullable = true)
 |-- plugin_hangs: integer (nullable = true)
 |-- aborts_plugin: integer (nullable = true)
 |-- aborts_content: integer (nullable = true)
 |-- aborts_gmplugin: integer (nullable = true)
 |-- crashes_detected_plugin: integer (nullable = true)
 |-- crashes_detected_content: integer (nullable = true)
 |-- crashes_detected_gmplugin: integer (nullable = true)
 |-- crash_submit_attempt_main: integer (nullable = true)
 |-- crash_submit_attempt_content: integer (nullable = true)
 |-- crash_submit_attempt_plugin: integer (nullable = true)
 |-- crash_submit_success_main: integer (nullable = true)
 |-- crash_submit_success_content: integer (nullable = true)
 |-- crash_submit_success_plugin: integer (nullable = true)
 |-- shutdown_kill: integer (nullable = true)
 |-- active_addons_count: long (nullable = true)
 |-- flash_version: string (nullable = true)
 |-- vendor: string (nullable = true)
 |-- is_default_browser: boolean (nullable = true)
 |-- default_search_engine_data_name: string (nullable = true)
 |-- default_search_engine: string (nullable = true)
 |-- loop_activity_counter: struct (nullable = true)
 |    |-- open_panel: integer (nullable = true)
 |    |-- open_conversation: integer (nullable = true)
 |    |-- room_open: integer (nullable = true)
 |    |-- room_share: integer (nullable = true)
 |    |-- room_delete: integer (nullable = true)
 |-- devtools_toolbox_opened_count: integer (nullable = true)
 |-- client_submission_date: string (nullable = true)
 |-- places_bookmarks_count: integer (nullable = true)
 |-- places_pages_count: integer (nullable = true)
 |-- push_api_notify: integer (nullable = true)
 |-- web_notification_shown: integer (nullable = true)
 |-- popup_notification_stats: map (nullable = true)
 |    |-- key: string
 |    |-- value: struct (valueContainsNull = true)
 |    |    |-- offered: integer (nullable = true)
 |    |    |-- action_1: integer (nullable = true)
 |    |    |-- action_2: integer (nullable = true)
 |    |    |-- action_3: integer (nullable = true)
 |    |    |-- action_last: integer (nullable = true)
 |    |    |-- dismissal_click_elsewhere: integer (nullable = true)
 |    |    |-- dismissal_leave_page: integer (nullable = true)
 |    |    |-- dismissal_close_button: integer (nullable = true)
 |    |    |-- dismissal_not_now: integer (nullable = true)
 |    |    |-- open_submenu: integer (nullable = true)
 |    |    |-- learn_more: integer (nullable = true)
 |    |    |-- reopen_offered: integer (nullable = true)
 |    |    |-- reopen_action_1: integer (nullable = true)
 |    |    |-- reopen_action_2: integer (nullable = true)
 |    |    |-- reopen_action_3: integer (nullable = true)
 |    |    |-- reopen_action_last: integer (nullable = true)
 |    |    |-- reopen_dismissal_click_elsewhere: integer (nullable = true)
 |    |    |-- reopen_dismissal_leave_page: integer (nullable = true)
 |    |    |-- reopen_dismissal_close_button: integer (nullable = true)
 |    |    |-- reopen_dismissal_not_now: integer (nullable = true)
 |    |    |-- reopen_open_submenu: integer (nullable = true)
 |    |    |-- reopen_learn_more: integer (nullable = true)
 |-- search_counts: array (nullable = true)
 |    |-- element: struct (containsNull = true)
 |    |    |-- engine: string (nullable = true)
 |    |    |-- source: string (nullable = true)
 |    |    |-- count: long (nullable = true)
 |-- active_addons: array (nullable = true)
 |    |-- element: struct (containsNull = true)
 |    |    |-- addon_id: string (nullable = true)
 |    |    |-- blocklisted: boolean (nullable = true)
 |    |    |-- name: string (nullable = true)
 |    |    |-- user_disabled: boolean (nullable = true)
 |    |    |-- app_disabled: boolean (nullable = true)
 |    |    |-- version: string (nullable = true)
 |    |    |-- scope: integer (nullable = true)
 |    |    |-- type: string (nullable = true)
 |    |    |-- foreign_install: boolean (nullable = true)
 |    |    |-- has_binary_components: boolean (nullable = true)
 |    |    |-- install_day: integer (nullable = true)
 |    |    |-- update_day: integer (nullable = true)
 |    |    |-- signed_state: integer (nullable = true)
 |    |    |-- is_system: boolean (nullable = true)
 |-- active_theme: struct (nullable = true)
 |    |-- addon_id: string (nullable = true)
 |    |-- blocklisted: boolean (nullable = true)
 |    |-- name: string (nullable = true)
 |    |-- user_disabled: boolean (nullable = true)
 |    |-- app_disabled: boolean (nullable = true)
 |    |-- version: string (nullable = true)
 |    |-- scope: integer (nullable = true)
 |    |-- type: string (nullable = true)
 |    |-- foreign_install: boolean (nullable = true)
 |    |-- has_binary_components: boolean (nullable = true)
 |    |-- install_day: integer (nullable = true)
 |    |-- update_day: integer (nullable = true)
 |    |-- signed_state: integer (nullable = true)
 |    |-- is_system: boolean (nullable = true)
 |-- blocklist_enabled: boolean (nullable = true)
 |-- addon_compatibility_check_enabled: boolean (nullable = true)
 |-- telemetry_enabled: boolean (nullable = true)
 |-- user_prefs: struct (nullable = true)
 |    |-- dom_ipc_process_count: integer (nullable = true)
 |-- max_concurrent_tab_count: integer (nullable = true)
 |-- tab_open_event_count: integer (nullable = true)
 |-- max_concurrent_window_count: integer (nullable = true)
 |-- window_open_event_count: integer (nullable = true)
 |-- total_uri_count: integer (nullable = true)
 |-- unfiltered_uri_count: integer (nullable = true)
 |-- unique_domains_count: integer (nullable = true)
 |-- submission_date_s3: string (nullable = true)
 |-- sample_id: string (nullable = true)
 |-- events: array (nullable = true)
 |    |-- element: struct (containsNull = true)
 |    |    |-- timestamp: long (nullable = false)
 |    |    |-- category: string (nullable = false)
 |    |    |-- method: string (nullable = false)
 |    |    |-- object: string (nullable = false)
 |    |    |-- string_value: string (nullable = true)
 |    |    |-- map_values: map (nullable = true)
 |    |    |    |-- key: string
 |    |    |    |-- value: string
</code></pre><p>For more detail on where these fields come from in the
<a href="https://gecko.readthedocs.io/en/latest/toolkit/components/telemetry/telemetry/data/main-ping.html" target="_blank">raw data</a>,
please look <a href="src/main/scala/views/MainSummaryView.scala">in the MainSummaryView code</a>
in the <code>buildSchema</code> function.</p>
<p>Most of the fields are simple scalar values, with a few notable exceptions:</p>
<ul>
<li>The <code>search_count</code> field is an array of structs, each item in the array representing
a 3-tuple of (<code>engine</code>, <code>source</code>, <code>count</code>). The <code>engine</code> field represents the name of
the search engine against which the searches were done. The <code>source</code> field represents
the part of the Firefox UI that was used to perform the search. It contains values
such as &quot;abouthome&quot;, &quot;urlbar&quot;, and &quot;searchbar&quot;. The <code>count</code> field contains the number
of searches performed against this engine+source combination during that subsession.
Any of the fields in the struct may be null (for example if the search key did not
match the expected pattern, or if the count was non-numeric).</li>
<li>The <code>loop_activity_counter</code> field is a simple struct containing inner fields for each
expected value of the <code>LOOP_ACTIVITY_COUNTER</code> Enumerated Histogram. Each inner field
is a count for that histogram bucket.</li>
<li>The <code>popup_notification_stats</code> field is a map of <code>String</code> keys to struct values,
each field in the struct being a count for the expected values of the
<code>POPUP_NOTIFICATION_STATS</code> Keyed Enumerated Histogram.</li>
<li>The <code>places_bookmarks_count</code> and <code>places_pages_count</code> fields contain the <strong>mean</strong>
value of the corresponding Histogram, which can be interpreted as the average number
of bookmarks or pages in a given subsession.</li>
<li>The <code>active_addons</code> field contains an array of structs, one for each entry in
the <code>environment.addons.activeAddons</code> section of the payload. More detail in
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1290181" target="_blank">Bug 1290181</a>.</li>
<li>The <code>theme</code> field contains a single struct in the same shape as the items in the
<code>active_addons</code> array. It contains information about the currently active browser
theme.</li>
<li>The <code>user_prefs</code> field contains a struct with values for preferences of interest.</li>
</ul>
<p>It is recommended to work with this dataset via <strong>Spark</strong> rather than <strong>sql.t.m.o</strong> -
due to the large number of records, queries can consume a lot of resources on the
shared cluster and impact other users. Queries via sql.t.m.o should limit to a
short <code>submission_date_s3</code> range, and ideally make use of the <code>sample_id</code> field.</p>
<p>When using Presto to query the data from sql.t.m.o, you can use the
<a href="https://prestodb.io/docs/current/sql/select.html#unnest" target="_blank"><code>UNNEST</code></a> feature to
access items in the <code>search_counts</code>, <code>popup_notification_stats</code> and <code>active_addons</code> fields.</p>
<p>For example, to compare the search volume for different search <code>source</code> values, you could use:</p>
<pre><code class="lang-sql">WITH search_data AS
  (<span class="hljs-keyword">SELECT</span> s.<span class="hljs-keyword">source</span> <span class="hljs-keyword">AS</span> search_source,
          s.<span class="hljs-keyword">count</span> <span class="hljs-keyword">AS</span> search_count
   <span class="hljs-keyword">FROM</span> main_summary <span class="hljs-keyword">CROSS</span> <span class="hljs-keyword">JOIN</span> UNNEST(search_counts) <span class="hljs-keyword">AS</span> t(s)
   <span class="hljs-keyword">WHERE</span> submission_date_s3 = <span class="hljs-string">&apos;20160510&apos;</span>
     <span class="hljs-keyword">AND</span> search_counts <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>)
<span class="hljs-keyword">SELECT</span> search_source, <span class="hljs-keyword">sum</span>(search_count) <span class="hljs-keyword">as</span> total_searches
<span class="hljs-keyword">FROM</span> search_data
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> search_source
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">sum</span>(search_count) <span class="hljs-keyword">DESC</span>
</code></pre>
<h1 id="appendix">Appendix</h1>
<p>This documentation is taken from the <a href="https://github.com/mozilla/telemetry-batch-view/tree/master/docs" target="_blank">telemetry-batch-view documentation</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="cross_sectional.html" class="navigation navigation-prev " aria-label="Previous page: Cross Sectional">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="CrashSummary.html" class="navigation navigation-next " aria-label="Next page: Crash Summary">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Main Summary","level":"1.3.2.2.3","depth":4,"next":{"title":"Crash Summary","level":"1.3.2.2.4","depth":4,"path":"datasets/batch_view/CrashSummary.md","ref":"datasets/batch_view/CrashSummary.md","articles":[]},"previous":{"title":"Cross Sectional","level":"1.3.2.2.2","depth":4,"path":"datasets/batch_view/cross_sectional.md","ref":"datasets/batch_view/cross_sectional.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["toc"],"pluginsConfig":{"toc":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"introduction.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"datasets/batch_view/MainSummary.md","mtime":"2017-04-27T12:26:26.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-04-27T14:54:38.087Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

